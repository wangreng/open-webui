# Open WebUI åœ¨ Fly.io çš„éƒ¨ç½²é…ç½®æ–‡ä»¶
# ä¿®å¤å¤šæœºå™¨å¯¼è‡´çš„ä¼šè¯çŠ¶æ€ä¸ä¸€è‡´é—®é¢˜

# ================================
# åº”ç”¨åŸºæœ¬ä¿¡æ¯
# ================================
app = "subvita-oi"                # ä½ çš„åº”ç”¨åç§°
primary_region = "den"            # Denver æ•°æ®ä¸­å¿ƒï¼ˆå»¶è¿Ÿè¾ƒä½ï¼‰

# ================================
# æ„å»ºé…ç½®
# ================================
[build]
  # ä½¿ç”¨ main æ ‡ç­¾ï¼Œç›¸æ¯” latest æ›´ç¨³å®š
  image = "ghcr.io/open-webui/open-webui:main"

# ================================
# ç¯å¢ƒå˜é‡é…ç½®
# ================================
[env]
  # å¯ç”¨ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
  WEBUI_AUTH = "True"
  
  # æ•°æ®ç›®å½•ï¼ˆä¸ºå°†æ¥çš„æŒä¹…åŒ–å­˜å‚¨åšå‡†å¤‡ï¼‰
  DATA_DIR = "/app/backend/data"
  
  # æ³¨æ„ï¼šæ•æ„Ÿä¿¡æ¯é€šè¿‡ Fly.io Secrets ç®¡ç†ï¼Œä¸åœ¨æ­¤å¤„é…ç½®ï¼š
  # - OPENAI_API_KEY (DeepSeek API å¯†é’¥)
  # - OPENAI_API_BASE_URL (https://api.deepseek.com)
  # - WEBUI_SECRET_KEY (ä¼šè¯åŠ å¯†å¯†é’¥)
  # - WEBUI_JWT_SECRET_KEY (JWT ä»¤ç‰Œå¯†é’¥)

# ================================
# HTTP æœåŠ¡é…ç½®
# ================================
[http_service]
  internal_port = 8080              # Open WebUI ç›‘å¬ç«¯å£
  force_https = true                # å¼ºåˆ¶ä½¿ç”¨ HTTPSï¼ˆå®‰å…¨ï¼‰
  auto_stop_machines = false        # ä¿æŒæœºå™¨è¿è¡Œï¼ˆé¿å…å†·å¯åŠ¨ï¼‰
  auto_start_machines = true        # è‡ªåŠ¨å¯åŠ¨æœºå™¨
  min_machines_running = 1          # æœ€å°‘ä¿æŒ 1 å°æœºå™¨è¿è¡Œ
  max_machines_running = 1          # ğŸ”¥ å…³é”®ï¼šé™åˆ¶æœ€å¤§æœºå™¨æ•°ä¸º 1ï¼ˆä¿®å¤ä¼šè¯é—®é¢˜ï¼‰

# ================================
# è™šæ‹Ÿæœºé…ç½®
# ================================
[[vm]]
  cpu_kind = "shared"               # å…±äº« CPUï¼ˆæˆæœ¬å‹å¥½ï¼‰
  cpus = 1                          # 1 ä¸ª CPU æ ¸å¿ƒ
  memory_mb = 4096                  # ğŸ”¥ å‡çº§åˆ° 4GB å†…å­˜ï¼ˆæå‡ç¨³å®šæ€§ï¼‰

# ================================
# éƒ¨ç½²ç­–ç•¥
# ================================
[deploy]
  strategy = "immediate"            # ç«‹å³éƒ¨ç½²ï¼Œä¸ç­‰å¾…å¥åº·æ£€æŸ¥

# ================================
# æœªæ¥å¯é€‰ï¼šæŒä¹…åŒ–å­˜å‚¨é…ç½®ï¼ˆæš‚æ—¶æ³¨é‡Šï¼‰
# ================================
# [mounts]
#   source = "openwebui_data"       # Volume åç§°
#   destination = "/app/backend/data"  # æŒ‚è½½è·¯å¾„
# 
# å¯ç”¨æŒä¹…åŒ–å­˜å‚¨éœ€è¦å…ˆåˆ›å»º Volumeï¼š
# fly volumes create openwebui_data --region den --size 10
